<!DOCTYPE html>
<html>

<head>
    <link rel="icon" type="image/png" href="../../images/logo.png">
    <link rel="stylesheet" href="style.css">
    <title>Latin Vocab Tester</title>
    <script>
        // Check for saved dark mode preference immediately to prevent flash
        if (localStorage.getItem('darkMode') === 'enabled') {
            document.documentElement.classList.add('dark-mode');
            document.addEventListener('DOMContentLoaded', function () {
                document.body.classList.add('dark-mode');
                document.getElementById('dark-mode-toggle').textContent = '\u00AC';
            });
        }
    </script>
</head>

<body>
    <div id="dark-mode-toggle" onclick="toggleDarkMode()">&#x00AC;</div>
    <script>
        function toggleDarkMode() {
            var body = document.body;
            var html = document.documentElement;
            body.classList.toggle('dark-mode');
            html.classList.toggle('dark-mode'); // Sync with html for full coverage if needed

            var toggleBtn = document.getElementById('dark-mode-toggle');
            if (body.classList.contains('dark-mode')) {
                localStorage.setItem('darkMode', 'enabled');
                // Icon allows stays as logical NOT
            } else {
                localStorage.setItem('darkMode', 'disabled');
            }
        }
    </script>
    <div style="display:none">
        <textarea id="d"></textarea>
        <br>
        <button
            onclick="data=[...d.value].map(n=>parseInt(n));localStorage.setItem('data',d.value);refresh()">Update</button>
        <hr>
    </div>
    <div style="text-align: center; margin-bottom: 10px;">
        <button
            onclick="var p=document.querySelector('.control-panel'); p.style.display = p.style.display === 'none' ? 'flex' : 'none';">Options</button>
    </div>
    <div class="control-panel" style="display: none;">
        <label for="min-l"><b>Min Level <span id="min-level-val">1</span></b></label>
        <input id="min-l" type="range" min="1" max="3" value="1" oninput="updateLevels('min')">

        <label for="max-l"><b>Max Level <span id="max-level-val">2</span></b></label>
        <input id="max-l" type="range" min="1" max="3" value="2" oninput="updateLevels('max')">

        <div style="margin: 10px 0; display: flex; align-items: center; gap: 5px;">
            <label for="reset-lvl-input">Reset Level:</label>
            <input type="number" id="reset-lvl-input" min="1" max="3" style="width: 50px; padding: 5px;">
            <button class="control-btn" onclick="resetLevel()">Reset</button>
        </div>

        <div class="button-group">
            <button class="control-btn" onclick="refresh()">Refresh</button>
            <button class="control-btn"
                onclick="if(confirm('Are you sure you want to reset ALL progress?')) { localStorage.clear(); location.reload(); }">Restart
                All</button>
        </div>
    </div>
    <hr>
    <div id="main"></div>
    <script>
        function shuffle(array) {
            let currentIndex = array.length;

            // While there remain elements to shuffle...
            while (currentIndex != 0) {

                // Pick a remaining element...
                let randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;

                // And swap it with the current element.
                [array[currentIndex], array[randomIndex]] = [
                    array[randomIndex], array[currentIndex]];
            }
        }

        let words, data, minLevel, maxLevel, shuffled;

        function updateLevels(changed) {
            let minInput = document.getElementById('min-l');
            let maxInput = document.getElementById('max-l');

            let min = parseInt(minInput.value);
            let max = parseInt(maxInput.value);

            if (min > max) {
                if (changed === 'min') {
                    // Updating min pushed it past max, so move max up
                    max = min;
                    maxInput.value = max;
                } else if (changed === 'max') {
                    // Updating max brought it below min, so move min down
                    min = max;
                    minInput.value = min;
                }
            }

            document.getElementById('min-level-val').textContent = min;
            document.getElementById('max-level-val').textContent = max;

            localStorage.setItem('minLevel', min);
            localStorage.setItem('maxLevel', max);

            minLevel = min;
            maxLevel = max;

            refresh();
        }

        function resetLevel() {
            let lvlInput = document.getElementById('reset-lvl-input');
            let lvl = parseInt(lvlInput.value);
            if (!lvl || lvl < 1 || lvl > 3) {
                alert("Please enter a valid level (1-3)");
                return;
            }

            // Loop through words to find matches for the level and uncheck them
            // 'words' is global and contains mapped indices from the last refresh call

            let count = 0;
            for (let i = 0; i < words.length; i++) {
                // words[i] is like ['word', 'def', 'type', level, index]
                // Wait, refresh() maps it: words = words.map((word, index) => [...word, index]);
                // So words[i][2] is level. words[i][3] is index in 'data'.
                if (words[i][2] === lvl) {
                    data[words[i][3]] = 0; // Uncheck
                    count++;
                }
            }

            d.value = data.join("");
            localStorage.setItem('data', data.join(""));
            refresh();
            alert(`Reset progress for Level ${lvl} (${count} words).`);
        }

        function refresh() {
            words = [['eager', 'acer', 1], ['vinegar', 'acer', 1], ['pilgrim', 'ager', 3], ['agile', 'ago', 2], ['essay', 'ago', 1], ['squat', 'ago', 2], ['adultery', 'alter', 2], ['exalt', 'altus', 2], ['haughty', 'altus', 3], ['advance', 'ante', 2], ['ancient', 'ante', 1], ['couple', 'aptus', 2], ['sewer', 'aqua', 2], ['eagle', 'aquila', 1], ['inert', 'ars', 1], ['easel', 'asinus', 1], ['obey', 'audio', 2], ['baguette', 'baculum', 1], ['debacle', 'baculum', 3], ['imbecile', 'baculum', 2], ['duel', 'bellum', 1], ['rebel', 'bellum', 1], ['revel', 'bellum', 1], ['beverage', 'bibo', 1], ['balance', 'bis', 2], ['combine', 'bis', 1], ['beau', 'bonus', 3], ['bonbon', 'bonus', 2], ['bounty', 'bonus', 1], ['beef', 'bos', 1], ['bugle', 'bos', 2], ['boil', 'bulla', 2], ['budge', 'bulla', 2], ['bullet', 'bulla', 1], ['chance', 'cado', 1], ['cheat', 'cado', 1], ['cement', 'caedo', 1], ['chisel', 'caedo', 1], ['caldron', 'caleo', 1], ['calorie', 'caleo', 1], ['chafe', 'caleo', 1], ['chowder', 'caleo', 2], ['nonchalant', 'caleo', 1], ['scald', 'caleo', 1], ['conciliate', 'calo', 2], ['calendar', 'calo', 2], ['council', 'calo', 2], ['nomenclature', 'calo', 2], ['champaign', 'campus', 2], ['champion', 'campus', 1], ['canary', 'canis', 2], ['kennel', 'canis', 3], ['accent', 'cano', 1], ['charm', 'cano', 2], ['enchant', 'cano', 1], ['incentive', 'cano', 2], ['cable', 'capio', 2], ['conceit', 'capio', 2], ['municipal', 'capio', 3], ['recover', 'capio', 2], ['achieve', 'caput', 1], ['cabbage', 'caput', 1], ['cattle', 'caput', 1], ['chapter', 'caput', 1], ['chef', 'caput', 1], ['precipice', 'caput', 1], ['carnation', 'caro', 2], ['carrion', 'caro', 2], ['casino', 'casa', 1], ['castle', 'castra', 2], ['chateau', 'castra', 2], ['cease', 'cedo', 1], ['necessary', 'cedo', 1], ['decree', 'cerno', 3], ['secret', 'cerno', 1], ['cinch', 'cingo', 3], ['succinct', 'cingo', 3], ['search', 'circus', 2], ['citadel', 'civis', 3], ['city', 'civis', 1], ['chiaroscuro', 'clamo', 3], ['clarity', 'clamo', 2], ['clarinet', 'clamo', 2], ['claim', 'clamo', 2], ['court', 'cohors', 3], ['curtsy', 'cohors', 3], ['courteous ', 'cohors', 3], ['accolade', 'collum', 3], ['collar', 'collum', 2], ['cult', 'colo', 2], ['counter', 'contra', 1], ['country', 'contra', 1], ['apricot', 'coquo', 1], ['biscuit', 'coquo', 1], ['cuisine', 'coquo', 1], ['terra-cotta', 'coquo', 1], ['cordial', 'cor', 1], ['core', 'cor', 1], ['courage', 'cor', 1], ['record', 'cor', 1], ['corps', 'corpus', 1], ['corsage', 'corpus', 2], ['corset', 'corpus', 2], ['coast', 'costa', 3], ['cutlet', 'costa', 3], ['accost', 'costa', 3], ['grease', 'crassus', 2], ['grate', 'cratis', 3], ['grid', 'cratis', 3], ['grill', 'cratis', 3], ['grant', 'credo', 2], ['miscreant', 'credo', 2], ['concubine', 'cubo', 3], ['covey', 'cubo', 3], ['succumb', 'cubo', 3], ['kiln', 'culina', 1], ['covet', 'cupio', 2], ['assure', 'cura', 1], ['ensure', 'cura', 1], ['insure', 'cura', 1], ['proctor', 'cura', 1], ['proxy', 'cura', 2], ['scour', 'cura', 2], ['devoir', 'debeo', 3], ['endeavor', 'debeo', 3], ['dandelion', 'dens', 1], ['adjourn', 'dies', 1], ['dial', 'dies', 1], ['dismal', 'dies', 1], ['journal', 'dies', 1], ['sojourn', 'dies', 1], ['dainty', 'dignus', 3], ['deign', 'dignus', 2], ['disdain', 'dignus', 3], ['betray', 'do', 1], ['dice', 'do', 1], ['dowry', 'do', 1], ['edit', 'do', 1], ['pardon', 'do', 1], ['render', 'do', 1], ['rendezvous', 'do', 1], ['rent', 'do', 1], ['traitor', 'do', 1], ['treason', 'do', 1], ['vendor', 'do', 1], ['bedlam', 'domus', 2], ['damsel', 'domus', 2], ['danger', 'domus', 2], ['dungeon', 'domus', 2], ['granny', 'domus', 2], ['madam', 'domus', 2], ['example', 'emo', 2], ['exempt', 'emo', 2], ['impromptu', 'emo', 2], ['premium', 'emo', 1], ['prompt', 'emo', 1], ['ransom', 'emo', 2], ['redeem', 'emo', 1], ['sample', 'emo', 1], ['vintage', 'emo', 2], ['ambition', 'eo', 1], ['circuit', 'eo', 1], ['county', 'eo', 1], ['issue', 'eo', 1], ['obituary', 'eo', 1], ['sudden', 'eo', 1], ['trance', 'eo', 1], ['viscount', 'eo', 2], ['estrange', 'extra', 2], ['external', 'extra', 1], ['strange', 'extra', 1], ['affair', 'facio', 1], ['chauffeur', 'caleo AND facio', 2], ['defeat', 'facio', 1], ['façade', 'facio', 1], ['facet', 'facio', 1], ['feat', 'facio', 1], ['fail', 'fallo', 1], ['fault', 'fallo', 1], ['affidavit', 'fido', 2], ['federal', 'fido', 2], ['fiancé', 'fido', 2], ['finesse', 'finis', 2], ['flour', 'flos', 2], ['fuel', 'focus', 2], ['fable', 'for', 3], ['fairy', 'for', 3], ['fate', 'for', 3], ['infant', 'for', 3], ['foreign', 'foris', 3], ['forest', 'foris', 3], ['forfeit', 'foris', 3], ['perforate', 'foro', 3], ['forensic', 'forum', 1], ['frail', 'frango', 2], ['fritter', 'frango', 2], ['osprey', 'frango', 1], ['friar', 'frater', 1], ['confuse', 'fundo', 3], ['funnel', 'fundo', 3], ['futile', 'fundo', 3], ['foundry', 'fundo', 3], ['ferret', 'fur', 1], ['furtive', 'fur', 1], ['congeal', 'gelu', 2], ['jelly', 'gelu', 2], ['benign', 'genus', 2], ['engine', 'genus', 2], ['ingenuity', 'genus', 2], ['germ', 'genus', 3], ['jaunty', 'genus', 3], ['jest', 'gero', 2], ['register', 'gero', 2], ['gravy', 'granum', 3], ['pomegranate ', 'granum', 3], ['able', 'habeo', 1], ['malady', 'habeo', 1], ['provender', 'habeo', 3], ['arbor', 'herba', 2], ['host', 'hospes', 1], ['hotel', 'hospes', 1], ['gist', 'iaceo', 2], ['joist', 'iaceo', 2], ['jet', 'iacio', 1], ['jetty', 'iacio', 1], ['jut', 'iacio', 1], ['entrée', 'inter', 2], ['jewel', 'iocus', 2], ['juggle', 'iocus', 2], ['jostle', 'iungo', 3], ['joust', 'iungo', 3], ['juice', 'ius', 3], ['justice', 'ius', 1], ['aid', 'iuvo', 1], ['coadjutor', 'iuvo', 3], ['jocund', 'iuvo', 2], ['avalanche', 'labor', 3], ['collapse', 'labor', 3], ['lettuce', 'lac', 2], ['dilate', 'latus', 1], ['deluge', 'lavo', 2], ['launder', 'lavo', 2], ['lava', 'lavo', 2], ['lotion', 'lavo', 2], ['leash', 'laxus', 3], ['release', 'laxus', 3], ['relish', 'laxus', 3], ['coil', 'lego', 1], ['legion', 'lego', 1], ['lesson', 'lego', 1], ['carnival', 'caro AND levis', 1], ['leaven', 'levis', 2], ['levy', 'levis', 2], ['loyalty', 'lex', 1], ['alloy', 'ligo', 2], ['ally', 'ligo', 2], ['liaison', 'ligo', 2], ['rally', 'ligo', 2], ['rely', 'ligo', 2], ['couch', 'locus', 3], ['lieu', 'locus', 3], ['lieutenant', 'locus', 3], ['lunge', 'longus', 2], ['maxim', 'magis', 2], ['mayor', 'magis', 2], ['manor', 'maneo', 1], ['mansion', 'maneo', 1], ['menial', 'maneo', 3], ['maintain', 'manus', 1], ['apron', 'mappa', 2], ['napkin', 'mappa', 2], ['cormorant', 'mare', 1], ['rosemary', 'mare', 1], ['demure', 'maturus', 3], ['comment', 'memini', 3], ['semester', 'mensis', 3], ['market', 'merx', 3], ['merchant', 'merx', 3], ['commerce', 'merx', 3], ['menu', 'minuo', 2], ['mince', 'minuo', 2], ['minute', 'minuo', 2], ['meddle', 'misceo', 3], ['medley', 'misceo', 3], ['melee', 'misceo', 3], ['promiscuous', 'misceo', 3], ['demise', 'mitto', 1], ['mess', 'mitto', 1], ['mold', 'modus', 2], ['monitor', 'moneo', 1], ['monster', 'moneo', 1], ['monument', 'moneo', 1], ['muster', 'moneo', 1], ['morose', 'mos', 2], ['mob', 'moveo', 2], ['moment', 'moveo', 1], ['motif', 'moveo', 1], ['mutiny', 'moveo', 1], ['immure', 'murus', 3], ['muscle', 'mus', 1], ['mussel', 'mus', 2], ['molt ', 'muto', 2], ['naïve', 'nascor', 2], ['denial', 'nego', 2], ['renegade', 'nego', 2], ['nephew', 'nepos', 1], ['niece', 'nepos', 1], ['innocent', 'noceo', 2], ['nuisance', 'noceo', 2], ['ignominy', 'nomen', 2], ['noun', 'nomen', 1], ['renown', 'nomen', 2], ['acquaint', 'nosco', 3], ['connoisseur', 'nosco', 3], ['notion', 'nosco', 3], ['noon', 'novem', 1], ['nuclear', 'nux', 2], ['antler', 'oculus', 1], ['eyelet', 'oculus', 1], ['inveigle', 'oculus', 1], ['annoy', 'odi', 1], ['ennui', 'odi', 1], ['cover', 'operio', 1], ['curfew', 'focus AND operio', 2], ['handkerchief', 'caput AND operio', 1], ['copy', 'ops', 3], ['office', 'ops', 3], ['inure', 'opus', 3], ['maneuver', 'opus', 2], ['manure', 'manus AND opus', 1], ['exorbitant', 'orbis', 3], ['aborigines', 'orior', 2], ['origin', 'orior', 2], ['adore', 'oro', 1], ['oracle', 'oro', 1], ['orison', 'oro', 2], ['negotiate', 'otium', 1], ['peninsula', 'paene', 1], ['compass', 'pando', 3], ['expansive', 'pando', 3], ['pace', 'pando', 3], ['pass', 'pando', 3], ['passage', 'pando', 3], ['password', 'pando', 3], ['spawn', 'pando', 3], ['dispatch', 'pango', 3], ['impinge', 'pango', 3], ['propaganda', 'pango', 3], ['appanage', 'panis', 3], ['pannier', 'panis', 3], ['pantry', 'panis', 1], ['pair', 'par', 1], ['peer', 'par', 1], ['umpire', 'non AND par', 2], ['parsimonious', 'parco', 3], ['appear', 'pareo', 2], ['apparition', 'pareo', 2], ['repertoire', 'pario', 3], ['dissever', 'paro', 2], ['emperor', 'paro', 1], ['parapet', 'paro', 1], ['several', 'paro', 1], ['jeopardy', 'iocus AND pars', 2], ['parcel', 'pars', 1], ['party', 'pars', 1], ['paraffin', 'parvus', 2], ['pattern', 'pater', 1], ['appease', 'pax', 1], ['pay', 'pax', 1], ['impair', 'peior', 2], ['append', 'pendeo', 1], ['appendage', 'pendeo (or pendo)', 1], ['pendant', 'pendeo (or pendo)', 1], ['pendulum', 'pendeo (or pendo)', 1], ['penthouse', 'pendeo (or pendo)', 2], ['propensity', 'pendeo (or pendo)', 2], ['avoirdupois', 'pendo (or pendo)', 3], ['expend', 'pendo', 1], ['pansy', 'pendo', 2], ['pension', 'pendo', 2], ['pensive', 'pendo', 2], ['poise', 'pendo', 2], ['pound', 'pendo', 2], ['stipend', 'pendo', 2], ['impeach', 'pes', 2], ['pawn', 'pes', 1], ['pedigree', 'pes', 2], ['pioneer', 'pes', 2], ['revamp', 'pes', 2], ['trivet', 'pes', 3], ['pellet', 'pila', 2], ['pill', 'pila', 1], ['platoon', 'pila', 2], ['peel', 'pilus', 3], ['pillage', 'pilus', 3], ['plush', 'pilus', 3], ['complaisant', 'placeo', 1], ['placid', 'placeo', 1], ['plea', 'placeo', 1], ['apply', 'plecto', 3], ['display', 'plecto', 3], ['employ', 'plecto', 3], ['pleat', 'plecto', 3], ['ply', 'plecto', 3], ['supple', 'plecto', 3], ['depot', 'pono', 1], ['expound', 'pono', 2], ['provost', 'pono', 2], ['pueblo', 'populus', 2], ['porcelain', 'porcus', 1], ['porcupine', 'porcus', 1], ['porpoise', 'piscis AND porcus', 1], ['porch', 'porta', 1], ['portico', 'porta', 2], ['porter', 'porto', 1], ['sport', 'porto', 1], ['posthumous', 'post', 3], ['puny', 'nascor AND post', 2], ['apprentice', 'prehendo', 3], ['apprise', 'prehendo', 3], ['enterprise', 'prehendo', 3], ['entrepreneur', 'prehendo', 3], ['impresario', 'prehendo', 3], ['pry', 'prehendo', 2], ['prison', 'prehendo', 2], ['surprise', 'prehendo', 2], ['print', 'premo', 1], ['reprimand', 'premo', 1], ['sprain', 'premo', 2], ['appraise', 'pretium', 1], ['appreciate', 'pretium', 1], ['price', 'pretium', 1], ['prize', 'pretium', 1], ['premier', 'prior', 1], ['prince', 'capio AND prior', 1], ['powder', 'pulvis', 3], ['poignant', 'pungo', 2], ['point', 'pungo', 2], ['puncture', 'pungo', 2], ['count', 'puto', 1], ['conquer', 'quaero', 2], ['discuss', 'quatio', 2], ['rescue', 'quatio', 2], ['squash (verb)', 'quatio', 2], ['quarantine', 'quattor', 1], ['quarry', 'quattor', 1], ['quire', 'quattor', 1], ['squad', 'quattor', 1], ['rage', 'rabio', 3], ['erase', 'rado', 1], ['raze', 'rado', 1], ['razor', 'rado', 1], ['ravage', 'rapio', 1], ['surreptitious', 'rapio', 2], ['address', 'rego', 1], ['adroit', 'rego', 2], ['alert', 'rego', 1], ['dress', 'rego', 1], ['rail', 'rego', 2], ['source', 'rego', 1], ['surge', 'rego', 1], ['realm', 'rex', 1], ['viceroy', 'rex', 2], ['derivative', 'rivus', 1], ['rival', 'rivus', 1], ['erosion', 'rodo', 3], ['rodent', 'rodo', 3], ['around', 'rota', 1], ['control', 'rota', 1], ['enroll', 'rota', 1], ['roll', 'rota', 1], ['roulette', 'rota', 1], ['round', 'rota', 1], ['rowel', 'rota', 2], ['abrupt', 'rumpo', 3], ['route', 'rumpo', 3], ['routine', 'rumpo', 3], ['sanction', 'sacer', 1], ['execration', 'sacer', 1], ['sexton', 'sacer', 3], ['salad', 'sal', 1], ['salary', 'sal', 1], ['sauce', 'sal', 1], ['sausage', 'sal', 1], ['assail', 'salio', 1], ['exult', 'salio', 1], ['result', 'salio', 1], ['saturated', 'satis', 1], ['scale', 'scando', 3], ['conscious', 'scio', 2], ['nice', 'scio', 1], ['shrive', 'scribo', 1], ['squire', 'scutum', 3], ['assess', 'sedeo', 1], ['session', 'sedeo', 1], ['siege', 'sedeo', 1], ['size', 'sedeo', 1], ['surcease', 'sedeo', 2], ['surly', 'senex', 2], ['seigneur', 'senex', 1], ['scent', 'sentio', 2], ['ensue', 'sequor', 1], ['intrinsic', 'sequor', 1], ['lawsuit', 'sequor', 1], ['obsequious', 'sequor', 1], ['sect', 'sequor', 1], ['set', 'sequor', 1], ['sue', 'sequor', 1], ['assert', 'sero', 3], ['desert', 'sero', 3], ['series', 'sero', 2], ['disseminate', 'sero', 3], ['season', 'sero', 3], ['dessert', 'servus', 1], ['sergeant', 'servus', 1], ['parasol', 'sol', 3], ['soldier', 'solidus', 2], ['cousin', 'soror', 1], ['arrest', 'sto', 1], ['cost', 'sto', 1], ['rest', 'sto', 1], ['stage', 'sto', 1], ['stay', 'sto', 1], ['distress', 'stringo', 3], ['prestige', 'stringo', 3], ['strain', 'stringo', 3], ['stress', 'stringo', 3], ['assuage', 'suavis', 1], ['entity', 'sum', 1], ['possible', 'sum', 1], ['puissance', 'sum', 2], ['soprano', 'super', 1], ['sovereign', 'super', 1], ['reticent', 'taceo', 1], ['attain', 'tango', 1], ['contagious', 'tango', 1], ['entire', 'tango', 1], ['integrate', 'tango', 1], ['taste', 'tango', 1], ['tentacle', 'tempto', 2], ['tense', 'tempus', 2], ['portent', 'tendo', 3], ['standard', 'tendo', 3], ['tent', 'tendo', 3], ['abstain', 'teneo', 1], ['rein', 'teneo', 1], ['tennis', 'teneo', 1], ['tenor', 'teneo', 2], ['terse', 'tergeo', 3], ['subtle', 'texo', 2], ['tiller', 'texo', 2], ['tissue', 'texo', 2], ['toilet', 'texo', 2], ['stain', 'tingo', 3], ['tint', 'tingo', 3], ['astonish', 'tono', 2], ['astound', 'tono', 2], ['stun', 'tono', 2], ['tornado', 'tono', 2], ['entreat', 'traho', 2], ['portray', 'traho', 2], ['trace', 'traho', 2], ['treaty', 'traho', 2], ['travail', 'tres', 1], ['travel', 'tres', 2], ['treble', 'tres', 1], ['truffle', 'tuber', 2], ['obtuse', 'tundo', 3], ['toil', 'tundo', 3], ['trouble', 'turba', 1], ['outrage', 'ultra', 2], ['inch', 'uncia', 1], ['ounce', 'uncia', 1], ['redundant', 'unda', 2], ['abundant', 'unda', 2], ['onion', 'unus', 1], ['usurp', 'rapio AND utor', 2], ['utensil', 'utor', 2], ['travesty', 'vestis', 1], ['vestry', 'vestis', 3], ['convey', 'via', 1], ['invoice', 'via', 1], ['envoy', 'via', 1], ['obvious', 'via', 1], ['trivial', 'tres AND via', 1], ['voyage', 'via', 1], ['avow', 'vox', 1], ['vouch', 'vox', 1], ['vowel', 'vox', 1]];
            data = [...(localStorage.getItem("data") || "")].map(n => parseInt(n));
            // [-2] is "Latin → English" (0) or "English → Latin" (1)
            // [-1] is "Grammar" (0) or "No Grammar" (1)

            minLevel = parseInt(localStorage.getItem("minLevel")) || 1;
            maxLevel = parseInt(localStorage.getItem("maxLevel")) || 2;

            // Initialize inputs
            if (document.getElementById('min-l').value != minLevel) document.getElementById('min-l').value = minLevel;
            if (document.getElementById('max-l').value != maxLevel) document.getElementById('max-l').value = maxLevel;
            document.getElementById('min-level-val').textContent = minLevel;
            document.getElementById('max-level-val').textContent = maxLevel;

            words = words.map((word, index) => [...word, index]);

            if (data.length != words.length + 2) {
                data = Array(words.length + 2).fill(0);
            }

            d.value = data.join("");

            // Ensure proper range for filtering
            let lower = Math.min(minLevel, maxLevel);
            let upper = Math.max(minLevel, maxLevel);

            shuffled = words.filter((word, index) => !data[index] && word[2] >= lower && word[2] <= upper)
            shuffle(shuffled);

            main.innerHTML = "";

            for (let index = 0; index < shuffled.length; index++) {
                main.insertAdjacentHTML("beforeend", `<b>${shuffled[index][data[data.length - 2]]}</b> <button class="reveal-btn" onclick="this.outerHTML=' — <i>${shuffled[index][1 - data[data.length - 2]].replaceAll("'", "\\'")}</i>'">Reveal</button> <input type="checkbox" onclick="data[${shuffled[index][3]}]=0+this.checked;d.value=data.join('');localStorage.setItem('data',data.join(''))"><br>`);
            }
        }

        refresh();
    </script>
</body>

</html>